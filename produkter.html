<!DOCTYPE html>
<html lang="">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="style.css">

    <style></style>

</head>

<body>
    <header>

        <div id="logo" onclick="window.location.href='index.html'"></div>

        <nav>
            <div id="menuknap">☰</div>
            <ul style="list-style-type:none" id="menu" class="hidden">
                <a href="index.html"></a>
                <li><a href="produkter.html">Værker</a></li>
                <li><a href="books.html">Bøger</a></li>
                <li><a href="om.html">Om</a></li>
                <li><a href="kontakt.html">Kontakt</a></li>
            </ul>

        </nav>
    </header>

    <nav>
        <h1 class="header_constant">Alle værker</h1>

        <button class="filter valgt" data-kategori="alle">
            <p>Alle Værker</p>
        </button>
        <button class="filter" data-kategori="malerier">
            <p>Malerier</p>
        </button>
        <button class="filter" data-kategori="plakater">
            <p>Plakater</p>
        </button>


    </nav>


    <main id="produkter"></main>
    <template>
        <article class="produkt">

            <img class="billede_produkt" src="">


        </article>
    </template>


    <script>
        document.addEventListener("DOMContentLoaded", start);
        let products;
        let filter = "alle";




        let url = "http://slodberg.dk/kea/2sm/10-eksamen/wordpress/wp-json/wp/v2/produkter?per_page=100";





        async function start() {
            let response = await fetch(url);

            products = await response.json();
            visProducts();
            toggleMenu();
            addEventlistnerToButtons();
            document.querySelector("#menuknap").addEventListener("click", toggleMenu);


        }


        function visProducts() {
            console.log("JSON forberedes" + products);

            let produkter = document.querySelector("#produkter");
            produkter.innerHTML = "";
            let template = document.querySelector("template");

            products.forEach(product => {

                if (filter == "alle" || filter == product.kategori) {


                    const klon = template.cloneNode(true).content;

                    klon.querySelector(".billede_produkt").src = product.billede.guid;

                    console.log(product.format_billede);
                    if (product.format_billede == 1) {
                        klon.querySelector("article").classList.add("bred");
                    }

                    klon.querySelector("article").addEventListener("click", () => {

                        location.href = `produkter_detalje.html?id=${product.id}`;

                    })

                    produkter.appendChild(klon);
                }
            });

        }



        function addEventlistnerToButtons() {
            document.querySelectorAll(".filter").forEach(elm => {
                elm.addEventListener("click", filterering);
            });
        }


        function filterering() {
            console.log("filter");
            filter = this.dataset.kategori;
            document.querySelector("h1").textContent = this.textContent;
            document.querySelectorAll(".filter").forEach(elm => {
                elm.classList.remove("valgt")
            })
            this.classList.add("valgt");

            visProducts();
        }


        function toggleMenu() {
            console.log("toggleMenu");
            document.querySelector("#menu").classList.toggle("hidden");

            let erSkjult = document.querySelector("#menu").classList.contains("hidden");

            if (erSkjult == true) {
                document.querySelector("#menuknap").textContent = "☰";
            } else {
                document.querySelector("#menuknap").textContent = "X";
            }
        }
    </script>
</body></html>
